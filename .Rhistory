library(plotly)
library(reshape2)
p <- ggplot(data, aes('Longitud', 'Latitud ', z= 'Irradiancia')) +
stat_contour(geom="polygon",aes(fill=stat(level))) +
scale_fill_distiller(palette = "Spectral", direction = -1)
ggplotly(p)
data <- read.table("C:/Users/adrgo/Downloads/Libro1 (3).csv", sep = ';', header = T)[, 1:6]
data = data[data$Mes == 'Enero',]
mapa <- readRDS("C:/Users/adrgo/Downloads/TFM/Data/gadm36_ESP_2_sf.rds")
col <- c("#0000FF", "#00FFFF", "#00FF00", "#FFFF00", "#FFA500", "#FF0000")
mapa = mapa[mapa$NAME_2 == c('Las Palmas', 'Santa Cruz de Tenerife'),]
names(mapa)[7] <- 'Provincia'
mapadata <- merge(mapa,data, by = 'Provincia', duplicateGeoms = TRUE)
map <-ggplot(data = mapadata)+
geom_sf()
map <- map + geom_density2d(data = mapadata, aes(x = 'Latitud ', y = 'Longitud')) +
stat_contour(geom = 'polygon',aes(x = 'Latitud ', y = 'Longitud ',  fill = stat(level)),
size = 0.01, bins = 16, geom = 'polygon') +
scale_fill_gradientn(colours=col) + scale_alpha(range = c(0.2, 1))
map
map <- map + geom_density2d(data = mapadata, aes(x = 'Latitud ', y = 'Longitud')) +
geom_density_2d(aes(fill = ..level..), geom = "polygon", colour="white") +
scale_fill_gradientn(colours=col) + scale_alpha(range = c(0.2, 1))
map
map <- map + geom_density2d(data = mapadata, aes(x = 'Latitud ', y = 'Longitud')) +
geom_density_2d(aes(x = 'Longitud', y = 'Latitud',fill = ..level..), geom = "polygon", colour="white") +
scale_fill_gradientn(colours=col) + scale_alpha(range = c(0.2, 1))
data <- read.table("C:/Users/adrgo/Downloads/Libro1 (3).csv", sep = ';', header = T)[, 1:6]
data = data[data$Mes == 'Enero',]
mapa <- readRDS("C:/Users/adrgo/Downloads/TFM/Data/gadm36_ESP_2_sf.rds")
col <- c("#0000FF", "#00FFFF", "#00FF00", "#FFFF00", "#FFA500", "#FF0000")
mapa = mapa[mapa$NAME_2 == c('Las Palmas', 'Santa Cruz de Tenerife'),]
names(mapa)[7] <- 'Provincia'
mapadata <- merge(mapa,data, by = 'Provincia', duplicateGeoms = TRUE)
map <-ggplot(data = mapa)+
geom_sf()
map <- map + geom_density2d(data = data, aes(x = lon, y = lat)) +
stat_density2d(data = data, aes(x = lon, y = lat,  fill = ..level.., alpha = ..level..),
size = 0.01, bins = 16, geom = 'polygon') +
scale_fill_gradientn(colours=col) + scale_alpha(range = c(0.2, 1))
map
map <- map + geom_density2d(data = data, aes(x = Longitud, y = Latitud)) +
stat_density2d(data = data, aes(x = Longitud, y = Latitud,  fill = ..level.., alpha = ..level..),
size = 0.01, bins = 16, geom = 'polygon') +
scale_fill_gradientn(colours=col) + scale_alpha(range = c(0.2, 1))
map <- map + geom_density2d(data = data, aes(x = Longitud, y = Latitud)) +
stat_density2d(data = data, aes(x = Longitud, y = Latitud,  fill = ..level.., alpha = ..level..),
size = 0.01, bins = 16, geom = 'polygon'))
map <- map + geom_density2d(data = data, aes(x = Longitud, y = Latitud)) +
stat_density2d(data = data, aes(x = Longitud, y = Latitud,  fill = ..level.., alpha = ..level..),
size = 0.01, bins = 16, geom = 'polygon')
map
data <- read.table("C:/Users/adrgo/Downloads/Libro1 (3).csv", sep = ';', header = T)[, 1:6]
data = data[data$Mes == 'Enero',]
mapa <- readRDS("C:/Users/adrgo/Downloads/TFM/Data/gadm36_ESP_2_sf.rds")
col <- c("#0000FF", "#00FFFF", "#00FF00", "#FFFF00", "#FFA500", "#FF0000")
mapa = mapa[mapa$NAME_2 == c('Las Palmas', 'Santa Cruz de Tenerife'),]
names(mapa)[7] <- 'Provincia'
mapadata <- merge(mapa,data, by = 'Provincia', duplicateGeoms = TRUE)
map <-ggplot(data = mapa)+
geom_sf()
map <- map + geom_density2d(data = data, aes(x = Longitud, y = Latitud)) +
stat_density2d(data = data, aes(x = Longitud, y = Latitud,  fill = ..level.., alpha = ..level..),
size = 0.01, bins = 16, geom = 'polygon')
map
map <- map + geom_density2d(data = data, aes(x = Longitud, y = Latitud)) +
stat_density2d(data = data, aes(x = Longitud, y = Latitud,  fill = ..level.., alpha = ..level..),
size = 0.01, bins = 16, geom = 'polygon')+
scale_fill_gradientn(colours=col)
map
map <- map + geom_density2d(data = data, aes(x = Longitud, y = Latitud)) +
stat_density2d(data = data, aes(x = Longitud, y = Latitud,  fill = ..level.., alpha = ..level..),
size = 0.01, bins = 16, geom = 'polygon')+
scale_fill_gradientn(colours=col)+ scale_alpha(range = c(0.2, 1))
map <- map + geom_density2d(data = data, aes(x = Longitud, y = Latitud)) +
stat_density2d(data = data, aes(x = Longitud, y = Latitud,  fill = ..level.., alpha = 0.5),
size = 0.01, bins = 16, geom = 'polygon')+
scale_fill_gradientn(colours=col)
map <- map + geom_density2d(data = data, aes(x = Longitud, y = Latitud)) +
stat_density2d(data = data, aes(x = Longitud, y = Latitud,  fill = 'Reds', alpha = 0.4),
size = 0.01, bins = 16, geom = 'polygon')
map
map <- map + geom_density2d(data = data, aes(x = Longitud, y = Latitud)) +
stat_density2d(data = data, aes(x = Longitud, y = Latitud,  fill = 'Red', alpha = 0.4),
size = 0.01, bins = 16, geom = 'polygon')
map
map <- map + geom_density2d(data = data, aes(x = Longitud, y = Latitud)) +
stat_density2d(data = data, aes(x = Longitud, y = Latitud,  fill = ..level.., alpha = 0.4),
size = 0.01, bins = 16, geom = 'polygon')
map
View(data)
map <- map + geom_density2d(data = data, aes(x = Longitud, y = Latitud)) +
stat_density2d(data = data, aes(x = Longitud, y = Latitud,  fill = ..level.., alpha = ..level..),
size = 0.01, bins = 16, geom = 'polygon')+
scale_fill_gradientn(colours=col) + scale_alpha(range = c(3, 5))
map <- map + geom_density2d(data = data, aes(x = Longitud, y = Latitud)) +
stat_density2d(data = data, aes(x = Longitud, y = Latitud,  fill = ..level.., alpha = ..level..),
size = 0.01, bins = 16, geom = 'polygon')+
scale_fill_gradientn(colours=col) + scale_alpha(range = c(0.2, 5))
map <- map + geom_density2d(data = data, aes(x = Longitud, y = Latitud)) +
stat_density2d(data = data, aes(x = Longitud, y = Latitud,  fill = ..level.., alpha = ..level..),
size = 0.01, bins = 16, geom = 'polygon')+
scale_fill_gradientn(colours=col)
map
data
data
data
data
data <- read.table("C:/Users/adrgo/Downloads/Libro1 (3).csv", sep = ';', header = T)[, 1:6]
data = data[data$Mes == 'Enero',]
mapa <- readRDS("C:/Users/adrgo/Downloads/TFM/Data/gadm36_ESP_2_sf.rds")
col <- c("#0000FF", "#00FFFF", "#00FF00", "#FFFF00", "#FFA500", "#FF0000")
mapa = mapa[mapa$NAME_2 == c('Las Palmas', 'Santa Cruz de Tenerife'),]
names(mapa)[7] <- 'Provincia'
mapadata <- merge(mapa,data, by = 'Provincia', duplicateGeoms = TRUE)
map <-ggplot(data = mapa)+
geom_sf()
map <- map + geom_density2d(data = data, aes(x = Longitud, y = Latitud)) +
stat_density2d(data = data, aes(x = Longitud, y = Latitud,  fill = ..level.., alpha = ..level..),
size = 0.01, bins = 16, geom = 'polygon')+
scale_fill_gradientn(colours=col)
map
data <- read.table("C:/Users/adrgo/Downloads/Libro1 (3).csv", sep = ';', header = T)[, 1:6]
data = data[data$Mes == 'Febrero',]
mapa <- readRDS("C:/Users/adrgo/Downloads/TFM/Data/gadm36_ESP_2_sf.rds")
col <- c("#0000FF", "#00FFFF", "#00FF00", "#FFFF00", "#FFA500", "#FF0000")
mapa = mapa[mapa$NAME_2 == c('Las Palmas', 'Santa Cruz de Tenerife'),]
names(mapa)[7] <- 'Provincia'
mapadata <- merge(mapa,data, by = 'Provincia', duplicateGeoms = TRUE)
map <-ggplot(data = mapa)+
geom_sf()
map <- map + geom_density2d(data = data, aes(x = Longitud, y = Latitud)) +
stat_density2d(data = data, aes(x = Longitud, y = Latitud,  fill = ..level.., alpha = ..level..),
size = 0.01, bins = 16, geom = 'polygon')+
scale_fill_gradientn(colours=col)
map
data <- read.table("C:/Users/adrgo/Downloads/Libro1 (3).csv", sep = ';', header = T)[, 1:6]
data = data[data$Mes == 'Marzo',]
mapa <- readRDS("C:/Users/adrgo/Downloads/TFM/Data/gadm36_ESP_2_sf.rds")
col <- c("#0000FF", "#00FFFF", "#00FF00", "#FFFF00", "#FFA500", "#FF0000")
mapa = mapa[mapa$NAME_2 == c('Las Palmas', 'Santa Cruz de Tenerife'),]
names(mapa)[7] <- 'Provincia'
mapadata <- merge(mapa,data, by = 'Provincia', duplicateGeoms = TRUE)
map <-ggplot(data = mapa)+
geom_sf()
map <- map + geom_density2d(data = data, aes(x = Longitud, y = Latitud)) +
stat_density2d(data = data, aes(x = Longitud, y = Latitud,  fill = ..level.., alpha = ..level..),
size = 0.01, bins = 16, geom = 'polygon')+
scale_fill_gradientn(colours=col)
map
meses = c('Enero', 'Febrero','Marzo','Abril','Mayo','Junio','Julio','Agosto','Septiembre','Octubre',
'Noviembre', 'Diciembre')
par(mfrow = c(4,3))
data <- read.table("C:/Users/adrgo/Downloads/Libro1 (3).csv", sep = ';', header = T)[, 1:6]
mapa <- readRDS("C:/Users/adrgo/Downloads/TFM/Data/gadm36_ESP_2_sf.rds")
mapa = mapa[mapa$NAME_2 == c('Las Palmas', 'Santa Cruz de Tenerife'),]
col <- c("#0000FF", "#00FFFF", "#00FF00", "#FFFF00", "#FFA500", "#FF0000")
for(i in 1:12){
data = data[data$Mes == meses[i],]
map <-ggplot(data = mapa)+
geom_sf()
map <- map + geom_density2d(data = data, aes(x = Longitud, y = Latitud)) +
stat_density2d(data = data, aes(x = Longitud, y = Latitud,  fill = ..level.., alpha = ..level..),
size = 0.01, bins = 16, geom = 'polygon')+
scale_fill_gradientn(colours=col)
map
}
map
par(mfrow = c(4,3))
data <- read.table("C:/Users/adrgo/Downloads/Libro1 (3).csv", sep = ';', header = T)[, 1:6]
mapa <- readRDS("C:/Users/adrgo/Downloads/TFM/Data/gadm36_ESP_2_sf.rds")
mapa = mapa[mapa$NAME_2 == c('Las Palmas', 'Santa Cruz de Tenerife'),]
col <- c("#0000FF", "#00FFFF", "#00FF00", "#FFFF00", "#FFA500", "#FF0000")
data = data[data$Mes == 'Enero',]
map <-ggplot(data = mapa)+
geom_sf()
map <- map + geom_density2d(data = data, aes(x = Longitud, y = Latitud)) +
stat_density2d(data = data, aes(x = Longitud, y = Latitud,  fill = ..level.., alpha = ..level..),
size = 0.01, bins = 16, geom = 'polygon')+
scale_fill_gradientn(colours=col)
map
toString(data$Irradiancia)
for(i in 1:length(data$Irradiancia)){}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(ggplot2)
library(dplyr)
library(sf)
library(readr)
library(ggplot2)
library(dplyr)
library(sf)
data <- read.table("C:/Users/adrgo/Downloads/Libro1 (3).csv", sep = ';', header = T)[, 1:6]
mapa <- readRDS("C:/Users/adrgo/Downloads/TFM/Data/gadm36_ESP_2_sf.rds")
mapa = mapa[mapa$NAME_2 == c('Las Palmas', 'Santa Cruz de Tenerife'),]
col = c("#0000FF", "#00FFFF", "#00FF00", "#FFFF00", "#FFA500", "#FF0000")
data = data[data$Mes == 'Enero',]
mp <- ggplot(data = mapa)+
geom_sf()
mp
mp <- mp + geom_density2d(data = data, aes(x = Longitud, y = Latitud)) +
stat_density2d(data = data, aes(x = Longitud, y = Latitud,  fill = ..level.., alpha = ..level..),
size = 0.01, bins = 16, geom = 'polygon')+
scale_fill_gradientn(colours=col)
mp
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(ggplot2)
library(dplyr)
library(sf)
data <- read.table("C:/Users/adrgo/Downloads//Libro1 (3).csv", sep = ';', header = T)[, 1:6]
mapa <- readRDS("C:/Users/adrgo/Downloads/TFM/Data/gadm36_ESP_2_sf.rds")
mapa = mapa[mapa$NAME_2 == c('Las Palmas', 'Santa Cruz de Tenerife'),]
col = c("#0000FF", "#00FFFF", "#00FF00", "#FFFF00", "#FFA500", "#FF0000")
data = data[data$Mes == 'Enero',]
mp <- ggplot(data = mapa)+
geom_sf()
mp
mp <- mp + geom_density2d(data = data, aes(x = Longitud, y = Latitud)) +
stat_density2d(data = data, aes(x = Longitud, y = Latitud,  fill = ..level.., alpha = ..level..),
size = 0.01, bins = 16, geom = 'polygon')+
scale_fill_gradientn(colours=col)
mp
library(tmap)
library(sp)
library(readr)
library(dplyr)
mapa <- readRDS("D:/Di_Pal/Novela/Tema R/gadm36_EST_3_sf.rds")
data <- read_csv("C:/Users/adrgo/Downloads/NoV/Elecciones1963.csv")
mapa = mapa[mapa$NAME_1 != "Ida-Viru",]
mapa = mapa[mapa$NAME_1 != "Valga",]
mapa = mapa[mapa$NAME_1 != "Põlva",]
mapa = mapa[mapa$NAME_1 != "Tartu",]
mapa = mapa[mapa$NAME_1 != "Jõgeva",]
mapa = mapa[mapa$NAME_1 != "Lääne",]
mapa = mapa[mapa$NAME_1 != "Võru",]
mapa = mapa[mapa$NAME_1 != "Peipsi",]
mapa = mapa[mapa$NAME_1 != "Lääne-Viru",]
mapa = mapa[mapa$NAME_1 != "Viljandi",]
mapa = mapa[mapa$NAME_1 != "Järva",]
mapa = mapa[mapa$NAME_1 != "Harju",]
mapa = mapa[mapa$NAME_1 != "Saare",]
names(mapa)[10] <- "Municipio Estonio"
names(mapa)[7] <- "Provincia Estonia"
Prob <- anti_join(data,mapa, by = 'Municipio Estonio')
mapadata = merge(mapa,data, by = c('Provincia Estonia','Municipio Estonio'))
tm_shape(mapadata[mapadata$Winner == 'P.N.R.',]) +
tm_polygons(col='P.N.R.', title = "P.N.R.", palette = "Blues", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata[mapadata$Winner == 'P.C.-P.A.',]) +
tm_polygons(col='P.C.-P.A.', title = "P.C.-P.A.", palette = "Purples", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata[mapadata$Winner == 'F.N.P.',]) +
tm_polygons(col='F.N.P.', title = "F.N.P.", palette = "Reds", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata[mapadata$Winner == 'P.T.N.',]) +
tm_polygons(col='P.T.N.', title = "P.T.N.", palette = "YlOrBr", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata[mapadata$Winner == 'P.D.A.',]) +
tm_polygons(col='P.D.A.', title = "P.D.A.", palette = "RdPu", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_facets(as.layers = TRUE)+
tm_legend(show = FALSE)
mapa1 <- readRDS("D:/Di_Pal/Novela/Tema R/gadm36_EST_2_sf.rds")
data1 <- read_csv("C:/Users/adrgo/Downloads/NoV/Elecciones1966Provincias.csv")
mapa1 = mapa1[mapa1$NAME_1 != "Ida-Viru",]
mapa1 = mapa1[mapa1$NAME_1 != "Valga",]
mapa1 = mapa1[mapa1$NAME_1 != "Põlva",]
mapa1 = mapa1[mapa1$NAME_1 != "Tartu",]
mapa1 = mapa1[mapa1$NAME_1 != "Jõgeva",]
mapa1 = mapa1[mapa1$NAME_1 != "Lääne",]
mapa1 = mapa1[mapa1$NAME_1 != "Võru",]
mapa1 = mapa1[mapa1$NAME_1 != "Peipsi",]
mapa1 = mapa1[mapa1$NAME_1 != "Lääne-Viru",]
mapa1 = mapa1[mapa1$NAME_1 != "Viljandi",]
mapa1 = mapa1[mapa1$NAME_1 != "Järva",]
mapa1 = mapa1[mapa1$NAME_1 != "Harju",]
mapa1 = mapa1[mapa1$NAME_1 != "Saare",]
names(mapa1)[7] <- "Provincia Estonia"
mapadata1 = merge(mapa1,data1, by = 'Provincia Estonia')
tm_shape(mapadata1[mapadata1$Winner == 'P.N.R.',]) +
tm_polygons(col='P.N.R.', title = "P.N.R.", palette = "Blues", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata1[mapadata1$Winner == 'P.C.-P.A.',]) +
tm_polygons(col='P.C.-P.A.', title = "P.C.-P.A.", palette = "Purples", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata1[mapadata1$Winner == 'F.N.P.',]) +
tm_polygons(col='F.N.P.', title = "P.C.-P.A.", palette = "Reds", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata1[mapadata1$Winner == 'P.D.A.',]) +
tm_polygons(col='P.D.A.', title = "P.C.-P.A.", palette = "RdPu", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_facets(as.layers = TRUE)+
tm_legend(show = FALSE)
tm_shape(mapadata1[mapadata1$Winner == 'P.N.R.',]) +
tm_polygons(col='P.N.R.', title = "P.N.R.", palette = "Blues", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata1[mapadata1$Winner == 'P.C.-P.A.',]) +
tm_polygons(col='P.C.-P.A.', title = "P.C.-P.A.", palette = "Purples", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata1[mapadata1$Winner == 'F.N.P.',]) +
tm_polygons(col='F.N.P.', title = "P.C.-P.A.", palette = "Reds", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata1[mapadata1$Winner == 'P.D.A.',]) +
tm_polygons(col='P.D.A.', title = "P.C.-P.A.", palette = "RdPu", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_facets(as.layers = TRUE)+
tm_graticules()+
tm_legend(show = FALSE)
tm_shape(mapadata1[mapadata1$Winner == 'P.N.R.',]) +
tm_polygons(col='P.N.R.', title = "P.N.R.", palette = "Blues", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata1[mapadata1$Winner == 'P.C.-P.A.',]) +
tm_polygons(col='P.C.-P.A.', title = "P.C.-P.A.", palette = "Purples", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata1[mapadata1$Winner == 'F.N.P.',]) +
tm_polygons(col='F.N.P.', title = "P.C.-P.A.", palette = "Reds", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata1[mapadata1$Winner == 'P.D.A.',]) +
tm_polygons(col='P.D.A.', title = "P.C.-P.A.", palette = "RdPu", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_facets(as.layers = TRUE)+
tm_legend(show = FALSE)
tm_shape(mapadata1[mapadata1$Winner == 'P.N.R.',]) +
tm_polygons(col='P.N.R.', title = "P.N.R.", palette = "Blues", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata1[mapadata1$Winner == 'P.C.-P.A.',]) +
tm_polygons(col='P.C.-P.A.', title = "P.C.-P.A.", palette = "Purples", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata1[mapadata1$Winner == 'F.N.P.',]) +
tm_polygons(col='F.N.P.', title = "P.C.-P.A.", palette = "Reds", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata1[mapadata1$Winner == 'P.D.A.',]) +
tm_polygons(col='P.D.A.', title = "P.C.-P.A.", palette = "RdPu", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_facets(as.layers = TRUE)+
tm_legend(show = FALSE)
library(tmap)
library(sp)
library(readr)
library(dplyr)
mapa <- readRDS("D:/Di_Pal/Novela/Tema R/gadm36_EST_3_sf.rds")
data <- read_csv("C:/Users/adrgo/Downloads/NoV/Elecciones1963.csv")
mapa = mapa[mapa$NAME_1 != "Ida-Viru",]
mapa = mapa[mapa$NAME_1 != "Valga",]
mapa = mapa[mapa$NAME_1 != "Põlva",]
mapa = mapa[mapa$NAME_1 != "Tartu",]
mapa = mapa[mapa$NAME_1 != "Jõgeva",]
mapa = mapa[mapa$NAME_1 != "Lääne",]
mapa = mapa[mapa$NAME_1 != "Võru",]
mapa = mapa[mapa$NAME_1 != "Peipsi",]
mapa = mapa[mapa$NAME_1 != "Lääne-Viru",]
mapa = mapa[mapa$NAME_1 != "Viljandi",]
mapa = mapa[mapa$NAME_1 != "Järva",]
mapa = mapa[mapa$NAME_1 != "Harju",]
mapa = mapa[mapa$NAME_1 != "Saare",]
names(mapa)[10] <- "Municipio Estonio"
names(mapa)[7] <- "Provincia Estonia"
Prob <- anti_join(data,mapa, by = 'Municipio Estonio')
mapadata = merge(mapa,data, by = c('Provincia Estonia','Municipio Estonio'))
tm_shape(mapadata) +
tm_polygons(col='P.T.N.', title = "Porcentaje de voto al P.T.N.", palette = "YlOrBr",
breaks = c(0,10,20,30,40,50,60,100)) +
tm_style_classic()
tm_shape(mapadata[mapadata$Winner == 'P.N.R.',]) +
tm_polygons(col='P.N.R.', title = "P.N.R.", palette = "Blues", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata[mapadata$Winner == 'P.C.-P.A.',]) +
tm_polygons(col='P.C.-P.A.', title = "P.C.-P.A.", palette = "Purples", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata[mapadata$Winner == 'F.N.P.',]) +
tm_polygons(col='F.N.P.', title = "F.N.P.", palette = "Reds", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata[mapadata$Winner == 'P.T.N.',]) +
tm_polygons(col='P.T.N.', title = "P.T.N.", palette = "YlOrBr", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata[mapadata$Winner == 'P.D.A.',]) +
tm_polygons(col='P.D.A.', title = "P.D.A.", palette = "RdPu", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_legend(show = FALSE)
mapa1 <- readRDS("D:/Di_Pal/Novela/Tema R/gadm36_EST_2_sf.rds")
data1 <- read_csv("C:/Users/adrgo/Downloads/NoV/Elecciones1966Provincias.csv")
mapa1 = mapa1[mapa1$NAME_1 != "Ida-Viru",]
mapa1 = mapa1[mapa1$NAME_1 != "Valga",]
mapa1 = mapa1[mapa1$NAME_1 != "Põlva",]
mapa1 = mapa1[mapa1$NAME_1 != "Tartu",]
mapa1 = mapa1[mapa1$NAME_1 != "Jõgeva",]
mapa1 = mapa1[mapa1$NAME_1 != "Lääne",]
mapa1 = mapa1[mapa1$NAME_1 != "Võru",]
mapa1 = mapa1[mapa1$NAME_1 != "Peipsi",]
mapa1 = mapa1[mapa1$NAME_1 != "Lääne-Viru",]
mapa1 = mapa1[mapa1$NAME_1 != "Viljandi",]
mapa1 = mapa1[mapa1$NAME_1 != "Järva",]
mapa1 = mapa1[mapa1$NAME_1 != "Harju",]
mapa1 = mapa1[mapa1$NAME_1 != "Saare",]
names(mapa1)[7] <- "Provincia Estonia"
mapadata1 = merge(mapa1,data1, by = 'Provincia Estonia')
tm_shape(mapadata1[mapadata1$Winner == 'P.C.-P.A.',]) +
tm_polygons(col='P.C.-P.A.', title = "P.N.R.", palette = "Blues", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata1[mapadata1$Winner == 'P.N.R.',]) +
tm_polygons(col='P.N.R.', title = "P.C.-P.A.", palette = "Purples", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata1[mapadata1$Winner == 'F.N.P.',]) +
tm_polygons(col='F.N.P.', title = "P.C.-P.A.", palette = "Reds", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata1[mapadata1$Winner == 'P.D.A.',]) +
tm_polygons(col='P.D.A.', title = "P.C.-P.A.", palette = "RdPu", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_legend(show = FALSE)
tm_shape(mapadata1[mapadata1$Winner == 'P.C.-P.A.',]) +
tm_polygons(col='P.C.-P.A.', title = "P.N.R.", palette = "Blues", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata1[mapadata1$Winner == 'F.N.P.',]) +
tm_polygons(col='F.N.P.', title = "P.C.-P.A.", palette = "Purples", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata1[mapadata1$Winner == 'P.N.R.',]) +
tm_polygons(col='P.N.R.', title = "P.C.-P.A.", palette = "Reds", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata1[mapadata1$Winner == 'P.D.A.',]) +
tm_polygons(col='P.D.A.', title = "P.C.-P.A.", palette = "RdPu", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_legend(show = FALSE)
tm_shape(mapadata1[mapadata1$Winner == 'F.N.P.',]) +
tm_polygons(col='F.N.P.', title = "P.N.R.", palette = "Blues", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata1[mapadata1$Winner == 'P.C.-P.A.',]) +
tm_polygons(col='P.C.-P.A.', title = "P.C.-P.A.", palette = "Purples", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata1[mapadata1$Winner == 'P.N.R.',]) +
tm_polygons(col='P.N.R.', title = "P.C.-P.A.", palette = "Reds", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_shape(mapadata1[mapadata1$Winner == 'P.D.A.',]) +
tm_polygons(col='P.D.A.', title = "P.C.-P.A.", palette = "RdPu", style = 'cont',
breaks = c(20,30,40,50,60,70,100))+
tm_legend(show = FALSE)
library(tmap)
library(sp)
library(readr)
library(dplyr)
mapa <- readRDS("Data/gadm36_ESP_2_sp.rds")
data <- read_csv("Resultados/Resultado_provincias.csv")
data$Winner <- ifelse(data$Diferencia > 0, 'Izquierda','Derecha')
mapa = mapa[mapa$NAME_2 == c('Almería','Cádiz','Córdoba','Granada','Huelva','Jaén','Málaga','Sevilla'),]
library(tmap)
library(sp)
library(readr)
library(dplyr)
mapa <- readRDS("Data/gadm36_ESP_2_sp.rds")
setwd('C:\Users\adrgo\Downloads\TFM')
setwd(r'C:\Users\adrgo\Downloads\TFM')
setwd('C:/Users/adrgo/Downloads/TFM')
mapa <- readRDS("Data/gadm36_ESP_2_sp.rds")
data <- read_csv("Resultados/Resultado_provincias.csv")
data$Winner <- ifelse(data$Diferencia > 0, 'Izquierda','Derecha')
mapa = mapa[mapa$NAME_2 == c('Almería','Cádiz','Córdoba','Granada','Huelva','Jaén','Málaga','Sevilla'),]
names(mapa)[7] <- 'Provincia'
mapadata <- merge(mapa,data, by = 'Provincia', duplicateGeoms = TRUE)
mp <- tm_shape(mapadata[mapadata$Winner == 'Derecha',]) +
tm_polygons(col='Derecha', title = "Derecha", palette = "Blues", style = 'cont',
breaks = c(30,40,50,60,70,80,100))+
tm_shape(mapadata[mapadata$Winner == 'Izquierda',]) +
tm_polygons(col='Izquierda', title = "Izquierda", palette = "Reds", style = 'cont',
breaks = c(30,40,50,60,70,80,100))+
tm_facets(along = "Elección", as.layers = TRUE)+
tm_layout(legend.outside = TRUE)+
tm_borders()
mp <- tm_shape(mapadata[mapadata$Winner == 'Izquierda',]) +
tm_polygons(col='Izquierda', title = "Izquierda", palette = "Reds", style = 'cont',
breaks = c(30,40,50,60,70,80,100))+
tm_shape(mapadata[mapadata$Winner == 'Derecha',]) +
tm_polygons(col='Derecha', title = "Derecha", palette = "Blues", style = 'cont',
breaks = c(30,40,50,60,70,80,100))+
tm_facets(along = "Elección", as.layers = TRUE)+
tm_layout(legend.outside = TRUE)+
tm_borders()
animation_tmap(mp, filename="Mapas/Mapa_provincias.gif", width = 1600, height = 1300,
dpi = 350, delay=100)
View(data)
View(mapadata)
library(tmap)
library(sp)
library(readr)
library(dplyr)
mapa <- readRDS("Data/gadm36_ESP_2_sp.rds")
data <- read_csv("Resultados/Resultado_provincias.csv")
data$Winner <- ifelse(data$Diferencia > 0, 'Izquierda','Derecha')
mapa = mapa[mapa$NAME_2 == c('Almería','Cádiz','Córdoba','Granada','Huelva','Jaén','Málaga','Sevilla'),]
names(mapa)[7] <- 'Provincia'
mapadata <- merge(mapa,data, by = 'Provincia', duplicateGeoms = TRUE)
mp <- tm_shape(mapadata[mapadata$Winner == 'Izquierda',]) +
tm_polygons(col='Izquierda', title = "Izquierda", palette = "Reds", style = 'cont',
breaks = c(30,40,50,60,70,80,100))+
tm_shape(mapadata[mapadata$Winner == 'Derecha',]) +
tm_polygons(col='Derecha', title = "Derecha", palette = "Blues", style = 'cont',
breaks = c(30,40,50,60,70,80,100))+
tm_facets(along = "Elección", as.layers = TRUE)+
tm_layout(legend.outside = TRUE)+
tm_borders()
animation_tmap(mp, filename="Mapas/Mapa_provincias.gif", width = 1600, height = 1300,
dpi = 350, delay=100)
mp <- tm_shape(mapadata[mapadata$Winner == 'Derecha',]) +
tm_polygons(col='Derecha', title = "Derecha", palette = "Blues", style = 'cont',
breaks = c(30,40,50,60,70,80,100))+
tm_shape(mapadata[mapadata$Winner == 'Izquierda',]) +
tm_polygons(col='Izquierda', title = "Izquierda", palette = "Reds", style = 'cont',
breaks = c(30,40,50,60,70,80,100))+
tm_facets(along = "Elección", as.layers = TRUE)+
tm_layout(legend.outside = TRUE)+
tm_borders()
animation_tmap(mp, filename="Mapas/Mapa_provincias.gif", width = 1600, height = 1300,
dpi = 350, delay=100)
